{% extends 'index.html' %}


{% block title %}
    Successful payment
{% endblock title %}

{% comment %}
    {% block banner %}
    {% endblock banner %}
{% endcomment %}

{% block content %}

<style>
    .success-payment-main {
        min-height: 100vh;
        display: grid;
        gap: 1rem;
        align-content: start;
        padding: 1rem 0;
    }

    .success-payment-receipt-info {
        width: 95%;
        max-width: 1200px;
        margin: 0 auto;
        background: var(--purple-30);
        padding: 1rem;
        border-radius: 10px;
        display: grid;
        gap: 0.8rem;
    }

    .payment-successful-header {
        letter-spacing: 0.05rem;
        color: rgb(255, 255, 255); 
        text-align: center;
        font-size: 1.4rem;
    }

    .payment-successful-text {
        letter-spacing: 0.05em;
        color: rgb(216, 216, 216);
        line-height: 1.3;
        max-width: 800px;
        text-wrap: balance;
        text-align: center;
    }

    .payment-successful-text > strong {
        color: white;
        word-break: break-all;
    }

    .payment-successful-order-history-btn {
        justify-self: center;
        text-decoration: none;
        padding: 0.7rem 1rem;
        border-radius: 20px;
        background: var(--orange-65);
        color: rgb(255, 255, 255);
        letter-spacing: 0.05rem;
    }

    .success-payment-wrapper {
        width: 95%;
        max-width: 1200px;
        margin: 0 auto;
        display: grid;
        gap: 1rem;
        border-radius: 10px;
        background: rgb(255, 255, 255);
        padding: 1rem;
    }

    .payment-success-customer-info-container {
        display: grid;
        border-radius: 10px;
    }

    .lg-payment-success-customer-info-container {
        display: none;
    }

    .payment-success-customer-info {
        display: grid;
        grid-template-columns: 30% 1fr;
        padding: 1rem;
        background: hsl(0, 0%, 85%);
    }
   
    .payment-success-customer-info:nth-child(even) {
        background: hsl(0, 0%, 95%);
    }

    .payment-success-customer-info:first-child {
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
    }

    .payment-success-customer-info:last-child {
        border-bottom-left-radius: 10px;
        border-bottom-right-radius: 10px;
    }

    .success-payment-order-receipts {
        display: grid;
        gap: 1rem;
    }

    .lg-success-payment-order-receipts {
        display: none;
    }

    .success-payment-order-receipt {
        display: grid;
        border-radius: 10px;
    }

    .success-payment-order-text {
        display: grid;
        grid-template-columns: 30% 1fr;
        padding: 1rem;
        color: rgb(0, 0, 0);
        background: hsl(0, 0%, 95%);
    }

    .success-payment-order-text:nth-child(odd) {
        background: hsl(0, 0%, 85%);
    }

    .success-payment-order-text:first-child {
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
    }

    .success-payment-order-text:last-child {
        border-bottom-left-radius: 10px;
        border-bottom-right-radius: 10px;
    }

    .payment-successful-amount-received-container {
        display: grid;
        border-radius: 10px;
    }

    .lg-payment-success-amount-received-container {
        display: none;
    }

    .payment-amount-received-text {
        padding: 1rem;
        display: grid;
        grid-template-columns: 30% 1fr;
        background: hsl(0, 0%, 85%)
    }

    .payment-amount-received-text:nth-child(even) {
        background: hsl(0, 0%, 95%)
    }

    .payment-amount-received-text:first-child {
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
    }

    .payment-amount-received-text:last-child {
        border-bottom-left-radius: 10px;
        border-bottom-right-radius: 10px;
    }

   
    @media screen and (min-width: 800px) {
        .success-payment-wrapper {
            gap: 0;
            padding: 1.3rem;
        }

        .payment-success-customer-info-container {
            display: none;
        }

        .success-payment-order-receipt {
            display: none;
        }

        .payment-successful-amount-received-container {
            display: none;
        }

        .lg-payment-success-customer-info-container {
            display: grid;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
        }

        .payment-success-customer-info-header {
            display: grid;
            gap: 0.5rem;
            grid-template-columns: repeat(3, 1fr);
            padding: 1rem;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
            background: hsl(0, 0%, 70%)
        }

        .payment-success-customer-info-text {
            display: grid;
            gap: 0.5rem;
            grid-template-columns: repeat(3, 1fr);
            padding: 1rem;
            background: hsl(0, 0%, 95%)
        }

        .lg-success-payment-order-receipts {
            display: grid;
        }

        .success-payment-order-headers {
            display: grid;
            gap: 0.5rem;
            padding: 1rem;
            grid-template-columns: repeat(5, 1fr);
            background: hsl(0, 0%, 70%)
        }

        .lg-success-payment-order-text {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
            padding: 1rem;
            color: rgb(0, 0, 0);
            background: hsl(0, 0%, 95%)
        }

        .lg-success-payment-order-text:nth-child(odd) {
            background: hsl(0, 0%, 93%)
        }

        @media (hover) {
            .lg-success-payment-order-text:hover {
                background: var(--purple-45) !important;
                color: white;
            }
            .lg-success-payment-order-text:nth-child(odd):hover {
                background: var(--purple-45) !important;
                color: white;
            }
        }

        .lg-payment-success-amount-received-container {
            display: grid;
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
        }

        .payment-amount-received-headers {
            display: grid;
            gap: 0.5rem;
            padding: 1rem;
            grid-template-columns: repeat(4, 1fr);
            background: hsl(0, 0%, 70%)
        }

        .lg-payment-amount-received-text {
            display: grid;
            gap: 0.5rem;
            padding: 1rem;
            grid-template-columns: repeat(4, 1fr);
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
            background: hsl(0, 0%, 95%)
        }
    }

    @media screen and (min-width: 1000px) {
        
        .success-payment-main {
            padding: 2rem 0;
        }
    }

</style>

    <div class="success-payment-main">
        <div class="success-payment-receipt-info">
            <h2 class="payment-successful-header">Payment was successful!</h2>
            <p class="payment-successful-text">
                The URL to your receipt has been sent to
                <strong>{{ email }}.</strong>
                Thank you very much for shopping at our AiAi Market. 
            </p>
            <a class="payment-successful-order-history-btn" href="{% url 'products:order-history' %}">See Order History</a>
        </div>
        <div class="success-payment-wrapper">
            <!-- For mobile screen -->
            <div class="payment-success-customer-info-container">
                <div class="payment-success-customer-info">
                    <h4>Order ID</h4>
                    <p>{{ receipt_id }}</p>
                    
                </div>
                <div class="payment-success-customer-info">
                    <h4>Customer</h4>
                    <p>
                        {% if customer %}
                            {{ customer }}
                        {% else %}
                            {{ cutomer.shippingaddress_set.all.first.first_name }} 
                            {{ cutomer.shippingaddress_set.all.first.last_name }}
                        {% endif %}
                    </p>
                </div>
                <div class="payment-success-customer-info">
                    <h4>Order Date</h4>
                    <p>{{ order_data }}</p>
                </div>
            </div>
            <!-- For large screen -->
            <div class="lg-payment-success-customer-info-container">
                <div class="payment-success-customer-info-header">
                    <h4>Order ID</h4>
                    <h4>Customer</h4>
                    <h4>Order Date</h4>
                </div>
                <div class="payment-success-customer-info-text">
                    <p>{{ receipt_id }}</p>
                    <p>
                        {% if customer %}
                            {{ customer }}
                        {% else %}
                            {{ cutomer.shippingaddress_set.all.first.first_name }} 
                            {{ cutomer.shippingaddress_set.all.first.last_name }}
                        {% endif %}
                    </p>
                    <p>{{ order_data }}</p>
                </div>
            </div>
            <div class="success-payment-order-receipts">
                {% for order in orders %}
                    <!-- For mobile screen -->
                    <a class="success-payment-order-receipt" target="_blank" href="{{ order.product.get_absolute_url }}">
                        <div class="success-payment-order-text">
                            <h4>Order</h4>
                            <p>{{ forloop.counter }}</p>
                        </div>
                        <div class="success-payment-order-text">
                            <h4>Name</h4>
                            <p>{{ order.product.name }}</p>
                        </div>
                        <div class="success-payment-order-text">
                            <h4>Qty</h4>
                            <p>{{ order.quantity }}</p>
                        </div>
                        <div class="success-payment-order-text">
                            <h4>Price</h4>
                            {% if order.product.get_discount_price %}
                                <p>P{{ order.product.get_discount_price}}</p>
                            {% else %}
                                <p>P{{ order.product.price_str_format}}</p>
                            {% endif %}
                        </div>
                        <div class="success-payment-order-text">
                            <h4>Total</h4>
                            {% comment %}
                                {% for obj in order_total %}
                                    {% if obj.id == order.id %}
                                        <p>P{{ obj.total }}</p>
                                    {% endif %}
                                {% endfor %}
                            {% endcomment %}
                            <p>P{{ order.get_order_total }}</p>
                        </div>
                    </a>
                {% endfor %}
            </div>
            <!-- For large screen -->
            <div class="lg-success-payment-order-receipts">
                <div class="success-payment-order-headers">
                    <h4>Order</h4>
                    <h4>Name</h4>
                    <h4>Qty</h4>
                    <h4>Price</h4>
                    <h4>Total</h4>
                </div>
                {% for order in orders %}
                    <a href="{{ order.product.get_absolute_url }}" class="lg-success-payment-order-text" target="_blank">
                        <p>{{ forloop.counter }}</p>
                        <p>{{ order.product.name }}</p>
                        <p>{{ order.quantity }}</p>
                        {% if order.product.get_discount_price %}
                            <p>P{{ order.product.get_discount_price}}</p>
                        {% else %}
                            <p>P{{ order.product.price_str_format}}</p>
                        {% endif %}
                        {% comment %}
                            {% for obj in order_total %}
                                {% if obj.id == order.id %}
                                    <p>P{{ obj.total }}</p>
                                {% endif %}
                            {% endfor %}
                        {% endcomment %}
                        <p>P{{ order.get_order_total }}</p>
                    </a>
                {% endfor %}
            </div>
            <!-- For mobile screen -->
            <div class="payment-successful-amount-received-container">
                <div class="payment-amount-received-text">
                    <h4>Savings</h4>
                    {% if basket_total.discount_amount %}
                        <p>P{{ basket_total.discount_amount }}</p>
                    {% else %}
                        <p>n/a</p>
                    {% endif %}
                </div>
                <div class="payment-amount-received-text">
                    <h4>Sub-total</h4>
                    <p>P{{ basket_total.sub_total }}</p>
                </div>
                <div class="payment-amount-received-text">
                    <h4>VAT</h4>
                    <p>P{{ basket_total.vat }}</p>
                </div>
                <div class="payment-amount-received-text">
                    <h4>Total</h4>
                    <p>P{{ basket_total.total }}</p>
                </div>
            </div>
            <!-- For large screen -->
            <div class="lg-payment-success-amount-received-container">
                <div class="payment-amount-received-headers">
                    <h4>Savings</h4>
                    <h4>Sub-total</h4>
                    <h4>VAT</h4>
                    <h4>Total</h4>
                </div>
                <div class="lg-payment-amount-received-text">
                    {% if basket_total.discount_amount %}
                        <p>P{{ basket_total.discount_amount }}</p>
                    {% else %}
                        <p>n/a</p>
                    {% endif %}
                    <p>P{{ basket_total.sub_total }}</p>
                    <p>P{{ basket_total.vat }}</p>
                    <p>P{{ basket_total.total }}</p>
                </div>
            </div>
        </div>
    </div>

{% endblock content %}